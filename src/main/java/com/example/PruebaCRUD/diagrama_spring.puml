@startuml
title "Arquitectura Spring Data JPA"

interface Repository<T, ID>

interface CrudRepository<T, ID> extends Repository {
    + save(entity: T): T
    + saveAll(entities: Iterable<T>): Iterable<T>
    + findById(id: ID): Optional<T>
    + existsById(id: ID): boolean
    + findAll(): Iterable<T>
    + count(): long
    + deleteById(id: ID): void
    + delete(entity: T): void
    + deleteAll(): void
}

interface PagingAndSortingRepository<T, ID> extends CrudRepository {
    + findAll(sort: Sort): Iterable<T>
    + findAll(pageable: Pageable): Page<T>
}

interface JpaRepository<T, ID> extends PagingAndSortingRepository {
    + flush(): void
    + saveAndFlush(entity: T): T
    + deleteInBatch(entities: Iterable<T>): void
    + deleteAllInBatch(): void
    + getOne(id: ID): T
}

interface QueryByExampleExecutor<T> {
    + findOne(example: Example<T>): Optional<T>
    + findAll(example: Example<T>): Iterable<T>
    + findAll(example: Example<T>, sort: Sort): Iterable<T>
    + count(example: Example<T>): long
    + exists(example: Example<T>): boolean
}

class SimpleJpaRepository<T, ID> implements JpaRepository, QueryByExampleExecutor {
    - entityManager: EntityManager
    - entityInformation: JpaEntityInformation
    + SimpleJpaRepository(entityInformation, entityManager)
}

' Tus repositories personalizados
interface PersonaRepository extends JpaRepository {
    + findByNombre(nombre: String): List<Persona>
    + findByApellido(apellido: String): List<Persona>
    + findByEdadGreaterThan(edad: int): List<Persona>
}

interface DocenteRepository extends JpaRepository {
    + findByCargo(cargo: String): List<Docente>
    + findByDepartamento(depto: String): List<Docente>
}

' Entidades JPA
class Persona {
    - id: Long
    - nombre: String
    - apellido: String
    - edad: int
    - {field} @Id
    - {field} @GeneratedValue
}

class Docente {
    - id: Long
    - cargo: String
    - departamento: String
    - {field} @Id
    - {field} @GeneratedValue
}

' Relaciones con implementación
SimpleJpaRepository .. PersonaRepository
SimpleJpaRepository .. DocenteRepository

' Relaciones con entidades
PersonaRepository .. Persona
DocenteRepository .. Docente

note right of Repository
  Interfaz marcadora base
  para repositorios
end note

note right of CrudRepository
  Operaciones CRUD básicas
end note

note right of PagingAndSortingRepository
  Agrega paginación
  y ordenamiento
end note

note right of JpaRepository
  Funcionalidad específica
  de JPA y más operaciones
  en lote
end note

note right of SimpleJpaRepository
  Implementación por defecto
  de JpaRepository
end note

note right of QueryByExampleExecutor
  Permite consultas
  por ejemplo (QBE)
end note

@enduml